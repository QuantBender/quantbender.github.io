[
  {
    "path": "projects/Stochastic Calculus For Finance Exercises Solutions/The Binomial No-Arbitrage Pricing Model/",
    "title": "The Binomial No-Arbitrage Pricing Model",
    "description": "This is a proposition of solutions to the exercises in the chapter 1 of the book \"Stochastic Calculus for Finance I: The Binomial Asset Pricing Model\" by Steven Shreve.",
    "author": [
      {
        "name": "QuantBender",
        "url": "https://quantbender.github.io"
      }
    ],
    "date": "2024-10-09",
    "categories": [],
    "contents": "\nExercise 1.1\nAssume in one-period binomial market of Section 1.1 that both H and T have positive probability of occuring. Show that condition (1.1.2) precludes arbitrage. In other words, show that if \\(X_0=0\\) and \\(X_1=\\Delta_0 S_1 + (1+r)(X_0-\\Delta_0 S_0)\\) then we cannot have \\(X_1\\) strictly positive with positive probability unless \\(X_1\\) is strictly negative with positive probability as well, and this is the case regardless of the choice of the number \\(\\Delta_0\\).\nAnswer:\nThe condition (1.1.2) is given by:\nIn the one-period binomial model, to rule out arbitrage we must assume \\(0 < d < 1+r < u\\).\nArbitrage is a trading strategy that involves no initial investment and has a positive probability of making a profit.\nLet’s assume that \\(X_0=0\\) and \\(X_1=\\Delta_0 S_1 + (1+r)(X_0-\\Delta_0 S_0)\\) for two possible states of the world \\(H\\) and \\(T\\). We have:\n\\[\n\\begin{aligned}\n\\begin{cases}\nX_1(H) &= \\Delta_0 S_1(H) + (1+r)(X_0-\\Delta_0 S_0(H)) \\\\\nX_1(T) &= \\Delta_0 S_1(T) + (1+r)(X_0-\\Delta_0 S_0(T))\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\nX_1(H) &= \\Delta_0 u S_0 + (1+r)(X_0-\\Delta_0 S_0) \\\\\nX_1(T) &= \\Delta_0 d S_0 + (1+r)(X_0-\\Delta_0 S_0)\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\n\\Delta_{0} = \\frac{X_1(H) - (1+r)X_0}{uS_0 - (1+r)S_0} \\\\\nX_1(T) = \\frac{X_1(H) - (1+r)X_0}{uS_0 - (1+r)S_0} d S_0 + (1+r)(X_0-\\frac{X_1(H) - (1+r)X_0}{uS_0 - (1+r)S_0} S_0)\n\\end{cases}\\\\\n&\\Rightarrow\nX_1(T) = \\frac{X_1(H) - (1+r)X_0}{u - (1+r)} d + (1+r)(X_0-\\frac{X_1(H) - (1+r)X_0}{u - (1+r)})\\\\\n&\\Rightarrow\nX_1(T)(u-1-r) = dX_1(H) - (1+r)dX_0 - X_1(H) + (1+r)(u-1-r)X_0 - (1+r)X_1(H) + (1+r)^2 X_0\\\\\n&\\Rightarrow\nX_1(T)(u-1-r) = (d - 1 - r)X_1(H) + (1+r)(-d+u-1-r+1+r)X_0\\\\\n&\\Rightarrow\nX_1(T)(u-1-r) = (d - 1 - r)X_1(H) + (1+r)(u-d)X_0\\\\\n&\\Rightarrow\n0 = X_0 = \\frac{1}{1+r}[\\frac{u-1-r}{u-d}X_1(T)+\\frac{1+r-d}{u-d}X_1(H)]\\\\\n&\\Rightarrow\n0 = X_0 = (u-1-r)X_1(T)+(1+r-d)X_1(H)]\\\\\n\\end{aligned}\n\\]\nFrom condition 1.1.2, we have \\(0 < d < 1+r < u\\). This implies that \\(u-1-r > 0\\) and \\(1+r-d > 0\\). Therefore, if \\(X_1(T) > 0\\) then \\(X_1(H) < 0\\) and vice versa. This shows that if \\(X_1\\) is strictly positive with positive probability, then \\(X_1\\) is strictly negative with positive probability as well.\nHence the condition (1.1.2) precludes arbitrage.\nExercise 1.2\nSuppose in in the situation of Example 1.1.1 that the option sells for 1.20 at time zero. Consider an agent who begins with wealth \\(X_0=0\\) and at time zero buys \\(\\Delta_0\\) shares of a stock and \\(\\Gamma_0\\) options. The numbers \\(\\Delta_0\\) and \\(\\Gamma_0\\) can be either positive or negative or zero. This leaves the agent with a cash position of \\(-4\\Delta_0-1.20\\Gamma_0\\). If this is positive, it is invested in the money market; if it is negative, it represents money borrowed from the money market. At time one, the value of the agent’s portfolio of stock, option, and money market assets is\n\\[\nX_1=\\Delta_0 S_1 +\\Gamma_0 (S_1-5)^{+} -\\frac{5}{4}(4\\Delta_0+1.20\\Gamma_0)\n\\]\nAssume that both H and T have positive probability of occuring. Show that if there is a positive probability that \\(X_1\\) is positive, then there is a positive probability that \\(X_1\\) is negative. In other words, one cannot find an arbitrage when time-zero price of the option is 1.20.\nAnswer:\nFrom the example, we know the following: \\(S_0=4\\), \\(S_1(H)=8\\), \\(S_1(T)=2\\), \\(r=\\frac{1}{4}\\), \\(u=2\\), \\(d=\\frac{1}{2}\\), and \\(X_0=0\\).\nThe value of the agent’s portfolio at time one is given by for two possible states of the world \\(H\\) and \\(T\\):\n\\[\n\\begin{aligned}\n\\begin{cases}\nX_1(H) &= \\Delta_0 S_1(H) +\\Gamma_0 (S_1(H)-5)^{+} -\\frac{5}{4}(4\\Delta_0+1.20\\Gamma_0) \\\\\nX_1(T) &= \\Delta_0 S_1(T) +\\Gamma_0 (S_1(T)-5)^{+} -\\frac{5}{4}(4\\Delta_0+1.20\\Gamma_0)\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\nX_1(H) &= \\Delta_0 8 +\\Gamma_0 (8-5)^{+} -\\frac{5}{4}(4\\Delta_0+1.20\\Gamma_0) \\\\\nX_1(T) &= \\Delta_0 2 +\\Gamma_0 (2-5)^{+} -\\frac{5}{4}(4\\Delta_0+1.20\\Gamma_0)\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\nX_1(H) &= 8\\Delta_0 +\\Gamma_0 (3) -5\\Delta_0-\\frac{3}{2}\\Gamma_0) \\\\\nX_1(T) &= 2\\Delta_0 +\\Gamma_0 (0) -5\\Delta_0-\\frac{3}{2}\\Gamma_0)\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\nX_1(H) &= 3\\Delta_0 +\\frac{3}{2}\\Gamma_0 \\\\\nX_1(T) &= -3\\Delta_0 -\\frac{3}{2}\\Gamma_0\n\\end{cases}\n\\end{aligned}\n\\]\nIf there is a positive probability that \\(X_1\\) is positive, then there is a positive probability that \\(X_1\\) is negative. This is because if \\(X_1(H) > 0\\) then \\(X_1(T) < 0\\) and vice versa. This shows that if \\(X_1\\) is strictly positive with positive probability, then \\(X_1\\) is strictly negative with positive probability as well.\nHence, one cannot find an arbitrage when the time-zero price of the option is 1.20.\nExercise 1.3\nIn the one-period binomial model of Section 1 . 1 , suppose we want to determine the price at time zero of the derivative security \\(V_1=S_1\\) (i.e., the derivative security pays off the stock price.) (This can be regarded as a European call with strike price K = 0 ) . What is the time-zero price \\(V_0\\) given by the risk-neutral pricing formula (1.1.10)?\nAnswer:\nThe risk-neutral pricing formula is given by:\n\\[\nV_0 = \\frac{1}{1+r} [\\tilde{p}V_1(H) + \\tilde{q}V_1(T)]\n\\]\nwhere \\(\\tilde{p} = \\frac{1+r-d}{u-d}\\) and \\(\\tilde{q} = \\frac{u-1-r}{u-d}\\).\nIn this case, we have \\(V_1(H) = S_1(H) = uS_0\\) and \\(V_1(T) = S_1(T) = dS_0\\). Therefore, the time-zero price \\(V_0\\) is given by:\n\\[\n\\begin{aligned}\nV_0 &= \\frac{1}{1+r} [\\tilde{p}V_1(H) + \\tilde{q}V_1(T)] \\\\\n&= \\frac{1}{1+r} [\\tilde{p}uS_0 + \\tilde{q}dS_0] \\\\\n&= \\frac{1}{1+r} [\\frac{1+r-d}{u-d}uS_0 + \\frac{u-1-r}{u-d}dS_0] \\\\\n&= \\frac{S_0}{1+r} [\\frac{u+ur-du+ud-d-dr}{u-d}] \\\\\n&= \\frac{S_0}{1+r} [\\frac{u-d+(u-d)r}{u-d}] \\\\\n&= \\frac{S_0}{1+r} [1+r] \\\\\n&= S_0\n\\end{aligned}\n\\]\n## Exercise 1.4.\nIn the proof of Theorem 1.2.2, show under the induction hypothesis that \\[X_{n+1}(\\omega_1\\omega_2...\\omega_nT)=V_{n+!}(\\omega_1\\omega_2...\\omega_nT)\\].\nAnswer:\n\\[\n\\begin{aligned}\nX_{n+1}(T) &= \\Delta_n d S_{n} + (1+r)(X_n - \\Delta_n S_n)\\\\\n           &= (1+r)X_n + \\Delta_n S_n (d - (1+r))\\\\\n           &= (1+r)V_n + \\Delta_n S_n (d - (1+r))\\quad [induction \\ hypothesis]\\\\\n           &= (1+r)V_n + [\\frac{V_{n+1}(H)-V_{n+1}(T)}{(u-d)S_{n}}] S_n (d - (1+r))\\\\\n           &= (1+r)V_n + [\\frac{V_{n+1}(T)-V_{n+1}(H)}{u-d}] (1+r - d)\\\\\n           &= (1+r)V_n +\\tilde{p}V_{n+1}(T) - \\tilde{p}V_{n+1}(H)\\\\\n           &= \\tilde{p}V_{n+1}(H) + \\tilde{q}V_{n+1}(T) + \\tilde{p}V_{n+1}(T) - \\tilde{p}V_{n+1}(H)\\\\\n           &= [\\tilde{p}+\\tilde{q}]V_{n+1}(T)\\\\\n           &= V_{n+1}(T)\n\\end{aligned}\n\\]\nExercise 1.5\nIn example 1.2.4, we considered an agent who sold the lookback option for \\(V_0=1.376\\) and bought \\(\\Delta_0=0.1733\\) shares of stock at time zero. At time one, if the stock goes up, she has a portfolio valued at \\(V_1(H)=2.24\\). Assume that she now takes a position of \\(\\Delta_1(H)=\\frac{V_2(HH)-V_2(HT)}{S_2(HH)-S_2(HT)}\\) in the stock. Show that, at time two, if the stock goes up again, she will have a portfolio valued at \\(V_2(HH) = 3.20\\), whereas if the stock goes down, her portfolio will be worth \\(V_2(HT)=2.40\\). Finally, under the assumption that the stock goes up in the first period and down in the second period, assume the agent takes the position \\(\\Delta_2(HT)=\\frac{V_3(HTH)-V_3(HTT)}{S_{3}(HTH)-S_3(HTT)}\\) in the stock. Show that at time three, if the stock goes up, she will have a portfolio valued at $V_3(HTH)= 0 $, whereas if the stock goes down, her portfolio will be worth \\(V_3(HTT)=6\\). In other words, she has hedged her short position in the option.\nAnswer: The exercise is almost solved in the book. We have the following data:\n\\(S_0 =4\\), \\(u=2\\), \\(d=\\frac{1}{2}\\), \\(r=\\frac{1}{4}\\), \\(\\tilde{p}=\\tilde{q}=\\frac{1}{2}\\), and \\(V_{3}=max_{0\\leq n \\leq 3} S_n - S_3\\).\nTHe stock price tree over the three periods is given below:\n\n\n\nDetermining the option value backward in time, we have:\n\\[\n\\begin{array}{ccccc}\nV_3(HHH) &= S_3(HHH) - S_3(HHH) &= 32 - 32 &= 0\\\\\nV_3(HHT) &= S_2(HH) - S_3(HHT) &= 16 - 8 &= 8\\\\\nV_3(HTH) &= S_1(H) - S_3(HTH) &= 8 - 8 &= 0\\\\\nV_3(HTT) &= S_1(H) - S_3(HTT) &= 8 - 2 &= 6\\\\\nV_3(THH) &= S_3(THH) - S_3(THH) &= 8 - 8 &= 0\\\\\nV_3(THT) &= S_2(TH) - S_3(THT) &= 4 - 2 &= 2\\\\\nV_3(TTH) &= S_0 - S_3(TTH) &= 4 - 2 &= 2\\\\\nV_3(TTT) &= S_0 - S_3(TTT) &= 4 - \\frac{1}{2} &= \\frac{7}{2}\\\\\n\\end{array}\n\\]\nFor the other periods, we use the backward recursion formula:\n\\[\n\\begin{aligned}\nV_2(HH) &= \\frac{1}{1+r}[\\tilde{p}V_3(HHH) + \\tilde{q}V_3(HHT)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_3(HHH) + \\frac{1}{2}V_3(HHT)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}0 + \\frac{1}{2}8]\\\\\n        &= \\frac{4}{5} \\times 4 = \\frac{16}{5} = 3.2\\\\\nV_2(HT) &= \\frac{1}{1+r}[\\tilde{p}V_3(HTH) + \\tilde{q}V_3(HTT)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_3(HTH) + \\frac{1}{2}V_3(HTT)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}0 + \\frac{1}{2}6]\\\\\n        &= \\frac{4}{5} \\times 3 = \\frac{12}{5} = 2.4\\\\\nV_2(TH) &= \\frac{1}{1+r}[\\tilde{p}V_3(THH) + \\tilde{q}V_3(THT)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_3(THH) + \\frac{1}{2}V_3(THT)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}0 + \\frac{1}{2}2]\\\\\n        &= \\frac{4}{5} \\times 1 = \\frac{4}{5} = 0.8\\\\\nV_2(TT) &= \\frac{1}{1+r}[\\tilde{p}V_3(TTH) + \\tilde{q}V_3(TTT)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_3(TTH) + \\frac{1}{2}V_3(TTT)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}2 + \\frac{1}{2}\\frac{7}{2}]\\\\\n        &= \\frac{4}{5} \\times \\frac{11}{4} = \\frac{11}{5} = 2.2\\\\\n\\end{aligned}\n\\]\nAnd in period 1:\n$$\n\\[\\begin{aligned}\nV_1(H) &= \\frac{1}{1+r}[\\tilde{p}V_2(HH) + \\tilde{q}V_2(HT)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_2(HH) + \\frac{1}{2}V_2(HT)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}\\frac{16}{5} + \\frac{1}{2}\\frac{12}{5}]\\\\\n        &= \\frac{4}{5} \\times \\frac{14}{5} = \\frac{56}{25} = 2.24\\\\\n        \nV_1(T) &= \\frac{1}{1+r}[\\tilde{p}V_2(TH) + \\tilde{q}V_2(TT)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_2(TH) + \\frac{1}{2}V_2(TT)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}\\frac{4}{5} + \\frac{1}{2}\\frac{11}{5}]\\\\\n        &= \\frac{4}{5} \\times \\frac{15}{10} = \\frac{6}{5} = 1.2\\\\\n\\end{aligned}\\]\n$$\nFinally, in period 0:\n\\[\n\\begin{aligned}\nV_0 &= \\frac{1}{1+r}[\\tilde{p}V_1(H) + \\tilde{q}V_1(T)]\\\\\n        &= \\frac{1}{1+\\frac{1}{4}}[\\frac{1}{2}V_1(H) + \\frac{1}{2}V_1(T)]\\\\\n        &= \\frac{1}{\\frac{5}{4}}[\\frac{1}{2}2.24 + \\frac{1}{2}1.2]\\\\\n        &= \\frac{4}{5} \\times \\frac{8.6}{5} = \\frac{34.4}{25} = 1.376\\\\\n\\end{aligned}\n\\]\nFrom the above, we can see that the agent has hedged her short position in the option.\nExercise 1.6 (Hedging a long position-one period).\nConsider a bank that has a long position in the European call written on the stock price in\nFigure 1.1.2. The call expires at time one and has strike price K = 5. In Section 1.1,\nwe determined the time-zero price of this call to be V0 = 1.20. At time zero,\nthe bank owns this option, which ties up capital V0 = 1.20. The bank wants to\nearn the interest rate 25% on this capital until time one (i.e., without investing any more money,\nand regardless of how the coin tossing turns out, the bank wants to have\n\\[\\frac{5}{4}.1.20=1.50\\]\nat time one, after collecting the payoff from the option (if any) at time one).\nSpecify how the bank’s trader should invest in the stock and money markets to accomplish this.\nAnswer:\nThe bank’s trader should set up a portfolio whose value negates the payoff of the option at time one. This is done by solving the equation:\n\\[\n(1+r)(X_0-\\Delta_0 S_0) + \\Delta_0 S_1 = -(S_1 - K)^{+}\n\\]\nWith a space of states of the world \\(H\\) and \\(T\\), we have:\n\\[\n\\begin{aligned}\n\\begin{cases}\n(1+r)(X_0-\\Delta_0 S_0) + \\Delta_0 S_1(H) &= -(S_1(H) - K)^{+} \\\\\n(1+r)(X_0-\\Delta_0 S_0) + \\Delta_0 S_1(T) &= -(S_1(T) - K)^{+}\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\n(1+\\frac{1}{4})(X_0-\\Delta_0 4) + \\Delta_0 8 &= -(8 - 5)^{+} \\\\\n(1+\\frac{1}{4})(X_0-\\Delta_0 4) + \\Delta_0 2 &= -(2 - 5)^{+}\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\n\\frac{5}{4}X_0 - 5\\Delta_0 + 8\\Delta_0 &= -3 \\\\\n\\frac{5}{4}X_0 - 5\\Delta_0 + 2\\Delta_0 &= 0\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\n\\frac{5}{4}X_0 + 3\\Delta_0 &= -3 \\\\\n\\frac{5}{4}X_0 - 3\\Delta_0 &= 0\n\\end{cases}\\\\\n&\\Rightarrow\n\\begin{cases}\nX_0 &= -\\frac{6}{5}=-1.2\\\\\n\\Delta_0 &= -\\frac{1}{2}=-0.5\n\\end{cases}\n\\end{aligned}\n\\]\nTherefore, the bank’s trader should invest in the stock and money markets by short selling 0.5 shares of stock at time zero, which will provide him with the capital of \\(0.5\\times S_0=0.5\\times 4=2\\). Then, the bank’s trader should invest \\(2-1.2=0.8\\) in the money market to hedge the risk related to the long call position on the European option, and put in a different money market account the remaining capital of \\(1.2\\) to earn the interest rate of 25% until time one.\n\n\n\n",
    "preview": "projects/Stochastic Calculus For Finance Exercises Solutions/The Binomial No-Arbitrage Pricing Model/distill-preview.png",
    "last_modified": "2024-10-09T00:17:17+01:00",
    "input_file": {},
    "preview_width": 443,
    "preview_height": 275
  }
]
